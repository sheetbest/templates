<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inventory Management - Track Your Stock</title>
  <meta name="description" content="Manage your inventory with real-time stock tracking, item details, and CRUD operations powered by Google Sheets and SheetBest API.">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.sheet.best/sheet-best-templates.js"></script>

  <script>
    document.addEventListener('sheetbest-load-complete', (event) => {
      document.getElementById('loading').classList.add('hidden');
      checkEmptyState();
    });

    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('div[data-sheet-best]').forEach(element => {
        element.addEventListener('sheetbest-load-failed', function(event) {
          console.log('Load failed:', event.detail.status, element.getAttribute('data-sheet-best'));
          document.getElementById('fail_message').classList.remove('hidden');
          document.getElementById('loading').classList.add('hidden');
        });
      });
    });

    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('form[data-sheet-best]').forEach(form => {
        form.addEventListener('submit-finished', (event) => {
          console.log('Item saved:', event);
          form.reset();
          form.querySelector('.returnMessage').textContent = 'Item saved successfully!';
          setTimeout(() => {
            hideItemForm();
            window.location.reload();
          }, 1500);
        });
      });
    });

    function showItemDetails(id, name, category, quantity, price, supplier, description) {
      document.getElementById('detailId').textContent = id;
      document.getElementById('detailName').textContent = name;
      document.getElementById('detailCategory').textContent = category;
      document.getElementById('detailQuantity').textContent = quantity;
      document.getElementById('detailPrice').textContent = price;
      document.getElementById('detailSupplier').textContent = supplier;
      document.getElementById('detailDescription').textContent = description;

      // Set edit form values
      document.getElementById('editId').value = id;
      document.getElementById('editName').value = name;
      document.getElementById('editCategory').value = category;
      document.getElementById('editQuantity').value = quantity;
      document.getElementById('editPrice').value = price;
      document.getElementById('editSupplier').value = supplier;
      document.getElementById('editDescription').value = description;

      document.getElementById('listView').classList.add('hidden');
      document.getElementById('detailView').classList.remove('hidden');
    }

    function showListView() {
      document.getElementById('detailView').classList.add('hidden');
      document.getElementById('listView').classList.remove('hidden');
      document.getElementById('itemForm').classList.add('hidden');
    }

    function showItemForm(mode = 'create') {
      const form = document.getElementById('itemForm');
      const title = document.getElementById('formTitle');

      if (mode === 'create') {
        title.textContent = 'Add New Item';
        document.getElementById('itemFormElement').reset();
        document.getElementById('formId').value = '';
        document.getElementById('formAction').value = 'create';
      } else {
        title.textContent = 'Edit Item';
        document.getElementById('formAction').value = 'edit';
        // Copy values from detail view
        document.getElementById('formId').value = document.getElementById('editId').value;
        document.getElementById('formName').value = document.getElementById('editName').value;
        document.getElementById('formCategory').value = document.getElementById('editCategory').value;
        document.getElementById('formQuantity').value = document.getElementById('editQuantity').value;
        document.getElementById('formPrice').value = document.getElementById('editPrice').value;
        document.getElementById('formSupplier').value = document.getElementById('editSupplier').value;
        document.getElementById('formDescription').value = document.getElementById('editDescription').value;
      }

      form.classList.remove('hidden');
      form.scrollIntoView({ behavior: 'smooth' });
    }

    function hideItemForm() {
      document.getElementById('itemForm').classList.add('hidden');
    }

    function deleteItem() {
      if (confirm('Are you sure you want to delete this item?')) {
        const itemId = document.getElementById('editId').value;
        // In a real implementation, you would make a DELETE request here
        alert('Delete functionality would be implemented here');
      }
    }

    function checkEmptyState() {
      const inventoryRows = document.querySelectorAll('.inventory-row');
      const emptyState = document.getElementById('empty_state');
      const inventoryTable = document.querySelector('.overflow-hidden');

      if (inventoryRows.length === 0) {
        emptyState.classList.remove('hidden');
        inventoryTable.classList.add('hidden');
      } else {
        emptyState.classList.add('hidden');
        inventoryTable.classList.remove('hidden');
      }
    }

    let sortDirection = {};

    function sortTable(columnIndex) {
      const table = document.getElementById('inventory-table');
      const rows = Array.from(table.querySelectorAll('.inventory-row'));

      // Toggle sort direction
      sortDirection[columnIndex] = sortDirection[columnIndex] === 'asc' ? 'desc' : 'asc';
      const isAscending = sortDirection[columnIndex] === 'asc';

      rows.sort((a, b) => {
        let aValue, bValue;

        switch(columnIndex) {
          case 0: // Item name
            aValue = a.querySelector('.font-medium').textContent.trim().toLowerCase();
            bValue = b.querySelector('.font-medium').textContent.trim().toLowerCase();
            break;
          case 1: // Category
            aValue = a.querySelector('.bg-blue-100').textContent.trim().toLowerCase();
            bValue = b.querySelector('.bg-blue-100').textContent.trim().toLowerCase();
            break;
          case 2: // Stock
            aValue = parseInt(a.cells[2].textContent.match(/\d+/)[0]);
            bValue = parseInt(b.cells[2].textContent.match(/\d+/)[0]);
            break;
          case 3: // Price
            aValue = parseFloat(a.cells[3].textContent.replace('$', ''));
            bValue = parseFloat(b.cells[3].textContent.replace('$', ''));
            break;
          case 4: // Supplier
            aValue = a.cells[4].textContent.trim().toLowerCase();
            bValue = b.cells[4].textContent.trim().toLowerCase();
            break;
        }

        if (columnIndex === 2 || columnIndex === 3) {
          // Numeric sorting
          return isAscending ? aValue - bValue : bValue - aValue;
        } else {
          // String sorting
          if (aValue < bValue) return isAscending ? -1 : 1;
          if (aValue > bValue) return isAscending ? 1 : -1;
          return 0;
        }
      });

      // Clear table and append sorted rows
      table.innerHTML = '';
      rows.forEach(row => table.appendChild(row));

      // Update sort indicators
      updateSortIndicators(columnIndex, isAscending);
    }

    function updateSortIndicators(activeColumn, isAscending) {
      const headers = document.querySelectorAll('th[onclick^="sortTable"]');
      headers.forEach((header, index) => {
        const svg = header.querySelector('svg');
        if (index === activeColumn) {
          svg.classList.remove('text-gray-400');
          svg.classList.add('text-blue-600');
          if (isAscending) {
            svg.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path>';
          } else {
            svg.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>';
          }
        } else {
          svg.classList.remove('text-blue-600');
          svg.classList.add('text-gray-400');
          svg.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>';
        }
      });
    }
  </script>
</head>
<body class="bg-white">
  <!-- List View -->
  <div id="listView" class="bg-white py-12 sm:py-16">
    <div class="mx-auto max-w-7xl px-6 lg:px-8">
      <div class="mx-auto max-w-2xl text-center">
        <h2 class="text-base/7 font-semibold text-blue-600">Inventory Management</h2>
        <p class="mt-2 text-balance text-4xl font-semibold tracking-tight text-gray-900 sm:text-5xl">Track Your Stock</p>
        <p class="mt-6 text-lg/8 text-gray-600">
          Manage your inventory with real-time stock tracking and detailed item information.
        </p>
      </div>

      <!-- Controls Section -->
      <div class="mx-auto mt-8 max-w-4xl">
        <div class="flex flex-col sm:flex-row gap-4 justify-between">
          <div class="flex flex-col sm:flex-row gap-4 flex-1">
            <div class="flex-1">
              <input type="text" id="searchInput" placeholder="Search items by name or category..."
                     class="block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-blue-600">
            </div>
            <div>
              <select id="categoryFilter" class="block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline-2 focus:-outline-offset-2 focus:outline-blue-600">
                <option value="">All Categories</option>
                <option value="Electronics">Electronics</option>
                <option value="Office Supplies">Office Supplies</option>
                <option value="Tools">Tools</option>
                <option value="Furniture">Furniture</option>
              </select>
            </div>
          </div>
          <div>
            <button onclick="showItemForm('create')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition-colors">
              Add New Item
            </button>
          </div>
        </div>
      </div>

      <!-- Loading State -->
      <div id="loading" class="mx-auto mt-16 max-w-6xl">
        <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
          <div class="animate-pulse">
            <div class="bg-gray-50 rounded-lg p-6">
              <div class="h-4 bg-gray-200 rounded w-3/4 mb-4"></div>
              <div class="h-3 bg-gray-200 rounded w-1/2 mb-2"></div>
              <div class="h-3 bg-gray-200 rounded w-1/3 mb-4"></div>
              <div class="h-8 bg-gray-200 rounded"></div>
            </div>
          </div>
          <div class="animate-pulse">
            <div class="bg-gray-50 rounded-lg p-6">
              <div class="h-4 bg-gray-200 rounded w-3/4 mb-4"></div>
              <div class="h-3 bg-gray-200 rounded w-1/2 mb-2"></div>
              <div class="h-3 bg-gray-200 rounded w-1/3 mb-4"></div>
              <div class="h-8 bg-gray-200 rounded"></div>
            </div>
          </div>
          <div class="animate-pulse">
            <div class="bg-gray-50 rounded-lg p-6">
              <div class="h-4 bg-gray-200 rounded w-3/4 mb-4"></div>
              <div class="h-3 bg-gray-200 rounded w-1/2 mb-2"></div>
              <div class="h-3 bg-gray-200 rounded w-1/3 mb-4"></div>
              <div class="h-8 bg-gray-200 rounded"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Error Message -->
      <div id="fail_message" class="hidden mx-auto mt-16 max-w-2xl text-center">
        <div class="rounded-lg bg-red-50 p-6">
          <p class="text-red-600">Failed to load inventory. Please try again later.</p>
        </div>
      </div>

      <!-- Empty State -->
      <div id="empty_state" class="hidden mx-auto mt-16 max-w-2xl text-center">
        <div class="rounded-lg bg-blue-50 p-8">
          <div class="mx-auto w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-4">
            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
            </svg>
          </div>
          <h3 class="text-lg font-semibold text-gray-900 mb-2">No items in inventory</h3>
          <p class="text-gray-600 mb-6">Get started by adding your first inventory item.</p>
          <button onclick="showItemForm('create')" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-md transition-colors">
            Add First Item
          </button>
        </div>
      </div>

      <!-- Inventory Table -->
      <div class="mx-auto mt-16 max-w-7xl">
        <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg">
          <table class="min-w-full divide-y divide-gray-300 bg-white">
            <thead class="bg-gray-50">
              <tr>
                <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 cursor-pointer hover:bg-gray-100" onclick="sortTable(0)">
                  <div class="flex items-center">
                    Item
                    <svg class="ml-2 h-4 w-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                    </svg>
                  </div>
                </th>
                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900 cursor-pointer hover:bg-gray-100" onclick="sortTable(1)">
                  <div class="flex items-center">
                    Category
                    <svg class="ml-2 h-4 w-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                    </svg>
                  </div>
                </th>
                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900 cursor-pointer hover:bg-gray-100" onclick="sortTable(2)">
                  <div class="flex items-center">
                    Stock
                    <svg class="ml-2 h-4 w-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                    </svg>
                  </div>
                </th>
                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900 cursor-pointer hover:bg-gray-100" onclick="sortTable(3)">
                  <div class="flex items-center">
                    Price
                    <svg class="ml-2 h-4 w-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                    </svg>
                  </div>
                </th>
                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900 cursor-pointer hover:bg-gray-100" onclick="sortTable(4)">
                  <div class="flex items-center">
                    Supplier
                    <svg class="ml-2 h-4 w-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
                    </svg>
                  </div>
                </th>
                <th scope="col" class="relative py-3.5 pl-3 pr-4 sm:pr-6">
                  <span class="sr-only">Actions</span>
                </th>
              </tr>
            </thead>
            <tbody id="inventory-table" class="divide-y divide-gray-200 bg-white" data-sheet-best="https://api.sheetbest.com/sheets/e7398ed2-0d27-44d2-8cf3-665f799ba64e">
              <tr class="inventory-row hover:bg-gray-50 cursor-pointer"
                  onclick="showItemDetails('{{ Id }}', '{{ Name }}', '{{ Category }}', '{{ Quantity }}', '{{ Price }}', '{{ Supplier }}', '{{ Description }}')">
                <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6">
                  <div class="flex items-center">
                    <div class="ml-4">
                      <div class="font-medium text-gray-900">{{ Name }}</div>
                      <div class="text-gray-500 text-xs">ID: {{ Id }}</div>
                    </div>
                  </div>
                </td>
                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                    {{ Category }}
                  </span>
                </td>
                <td class="whitespace-nowrap px-3 py-4 text-sm">
                  <span class="font-medium {{ Quantity < 10 ? 'text-red-600' : 'text-gray-900' }}">
                    {{ Quantity }} units
                  </span>
                </td>
                <td class="whitespace-nowrap px-3 py-4 text-sm font-medium text-green-600">
                  ${{ Price }}
                </td>
                <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
                  {{ Supplier }}
                </td>
                <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                  <button onclick="event.stopPropagation(); showItemDetails('{{ Id }}', '{{ Name }}', '{{ Category }}', '{{ Quantity }}', '{{ Price }}', '{{ Supplier }}', '{{ Description }}')"
                          class="text-blue-600 hover:text-blue-900">
                    View<span class="sr-only">, {{ Name }}</span>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Detail View -->
  <div id="detailView" class="hidden bg-white py-12 sm:py-16">
    <div class="mx-auto max-w-4xl px-6 lg:px-8">
      <!-- Header -->
      <div class="flex items-center justify-between mb-8">
        <button onclick="showListView()" class="flex items-center text-blue-600 hover:text-blue-700">
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
          Back to Inventory
        </button>
        <div class="flex gap-2">
          <button onclick="showItemForm('edit')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition-colors">
            Edit Item
          </button>
          <button onclick="deleteItem()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md transition-colors">
            Delete
          </button>
        </div>
      </div>

      <!-- Item Details -->
      <div class="bg-white border border-gray-200 rounded-lg p-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <div>
            <h1 class="text-3xl font-bold text-gray-900 mb-4" id="detailName"></h1>
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-500">ID</label>
                <p class="text-lg text-gray-900" id="detailId"></p>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-500">Category</label>
                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800" id="detailCategory"></span>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-500">Supplier</label>
                <p class="text-lg text-gray-900" id="detailSupplier"></p>
              </div>
            </div>
          </div>

          <div>
            <div class="space-y-6">
              <div class="bg-green-50 rounded-lg p-6">
                <div class="text-center">
                  <div class="text-3xl font-bold text-green-600" id="detailPrice"></div>
                  <div class="text-sm text-green-600">Current Price</div>
                </div>
              </div>

              <div class="bg-gray-50 rounded-lg p-6">
                <div class="text-center">
                  <div class="text-3xl font-bold text-gray-900" id="detailQuantity"></div>
                  <div class="text-sm text-gray-600">Units in Stock</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-8 pt-8 border-t border-gray-200">
          <label class="block text-sm font-medium text-gray-500 mb-2">Description</label>
          <p class="text-gray-900 leading-relaxed" id="detailDescription"></p>
        </div>

        <!-- Hidden form fields for editing -->
        <div class="hidden">
          <input type="hidden" id="editId">
          <input type="hidden" id="editName">
          <input type="hidden" id="editCategory">
          <input type="hidden" id="editQuantity">
          <input type="hidden" id="editPrice">
          <input type="hidden" id="editSupplier">
          <input type="hidden" id="editDescription">
        </div>
      </div>
    </div>
  </div>

  <!-- Item Form Section -->
  <div id="itemForm" class="hidden mx-auto max-w-3xl px-6 lg:px-8 mt-16">
    <div class="bg-gray-50 rounded-lg p-8">
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-xl font-semibold text-gray-900" id="formTitle">Add New Item</h3>
        <button onclick="hideItemForm()" class="text-gray-400 hover:text-gray-600">
          <span class="sr-only">Close</span>
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <form id="itemFormElement" class="space-y-6" data-sheet-best="https://api.sheetbest.com/sheets/e7398ed2-0d27-44d2-8cf3-665f799ba64e/">
        <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
          <div>
            <label for="formName" class="block text-sm font-medium text-gray-900 mb-2">Item Name *</label>
            <input type="text" name="Name" id="formName" required
                   class="block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline-2 focus:-outline-offset-2 focus:outline-blue-600">
          </div>

          <div>
            <label for="formCategory" class="block text-sm font-medium text-gray-900 mb-2">Category *</label>
            <select name="Category" id="formCategory" required
                    class="block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline-2 focus:-outline-offset-2 focus:outline-blue-600">
              <option value="">Select Category</option>
              <option value="Electronics">Electronics</option>
              <option value="Office Supplies">Office Supplies</option>
              <option value="Tools">Tools</option>
              <option value="Furniture">Furniture</option>
            </select>
          </div>
        </div>

        <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
          <div>
            <label for="formQuantity" class="block text-sm font-medium text-gray-900 mb-2">Quantity *</label>
            <input type="number" name="Quantity" id="formQuantity" required min="0"
                   class="block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline-2 focus:-outline-offset-2 focus:outline-blue-600">
          </div>

          <div>
            <label for="formPrice" class="block text-sm font-medium text-gray-900 mb-2">Price *</label>
            <input type="number" name="Price" id="formPrice" required min="0" step="0.01"
                   class="block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline-2 focus:-outline-offset-2 focus:outline-blue-600">
          </div>
        </div>

        <div>
          <label for="formSupplier" class="block text-sm font-medium text-gray-900 mb-2">Supplier *</label>
          <input type="text" name="Supplier" id="formSupplier" required
                 class="block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline-2 focus:-outline-offset-2 focus:outline-blue-600">
        </div>

        <div>
          <label for="formDescription" class="block text-sm font-medium text-gray-900 mb-2">Description</label>
          <textarea name="Description" id="formDescription" rows="4"
                    placeholder="Enter item description..."
                    class="block w-full rounded-md bg-white px-3 py-2 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline-2 focus:-outline-offset-2 focus:outline-blue-600"></textarea>
        </div>

        <div class="text-center">
          <p class="text-sm text-blue-600 returnMessage mb-4"></p>
        </div>

        <div class="flex items-center justify-end gap-4">
          <input type="hidden" name="Id" id="formId">
          <input type="hidden" name="LastUpdated" id="lastUpdated">
          <input type="hidden" id="formAction" value="create">
          <button type="button" onclick="hideItemForm()" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50">
            Cancel
          </button>
          <button type="submit" class="px-6 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
            Save Item
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Footer -->
  <div class="mx-auto max-w-7xl px-6 lg:px-8 py-8">
    <div class="border-t border-gray-200 pt-8 text-center">
      <p class="text-sm text-gray-600">Powered by <a href="https://sheetbest.com" class="text-blue-600 hover:underline">Sheet Best</a> and Google Sheets â„¢</p>
      <p class="text-sm text-gray-500 mt-2">Find this code on <a href="https://github.com/sheetbest/templates" class="text-blue-600 hover:underline">GitHub</a></p>
    </div>
  </div>

  <script>
    // Set last updated timestamp when form is shown
    document.addEventListener('DOMContentLoaded', () => {
      const now = new Date().toISOString();
      document.getElementById('lastUpdated').value = now;
    });

    // Basic search functionality (client-side filtering)
    document.addEventListener('DOMContentLoaded', () => {
      const searchInput = document.getElementById('searchInput');
      const categoryFilter = document.getElementById('categoryFilter');

      function filterItems() {
        const searchTerm = searchInput.value.toLowerCase();
        const selectedCategory = categoryFilter.value;
        const itemRows = document.querySelectorAll('.inventory-row');

        itemRows.forEach(row => {
          const name = row.querySelector('.font-medium').textContent.toLowerCase();
          const content = row.textContent.toLowerCase();
          const category = row.querySelector('.bg-blue-100').textContent.trim();

          const matchesSearch = name.includes(searchTerm) || content.includes(searchTerm);
          const matchesCategory = !selectedCategory || category === selectedCategory;

          if (matchesSearch && matchesCategory) {
            row.style.display = 'table-row';
          } else {
            row.style.display = 'none';
          }
        });
      }

      searchInput.addEventListener('input', filterItems);
      categoryFilter.addEventListener('change', filterItems);
    });

    // Generate unique ID for new items
    function generateId() {
      return 'INV-' + Date.now().toString(36).toUpperCase();
    }

    // Set ID for new items before form submission
    document.getElementById('itemFormElement').addEventListener('submit', function(e) {
      const action = document.getElementById('formAction').value;
      if (action === 'create' && !document.getElementById('formId').value) {
        document.getElementById('formId').value = generateId();
      }
    });
  </script>
</body>
</html>